Explain that the new architecture is built around a fully orchestrated and modular bootstrap process centered on:

main() {
  preflight_checks
  install_system_layer
  install_core_daemon
  install_api_gateway
  install_panel
  configure_reverse_proxy
  create_admin_user
  enable_services
  secure_server
  post_install_summary
}

Each function must be documented with:

Its purpose

Actions performed

Files involved

Dependencies

Potential risks

Rollback mechanisms

ğŸ“‚ Project Architecture

Document and explain the new structure:

installer/
â”œâ”€â”€ bootstrap/
â”œâ”€â”€ steps/
â”œâ”€â”€ templates/
â”œâ”€â”€ systemd/
â”œâ”€â”€ nginx/
â”œâ”€â”€ database/
â”œâ”€â”€ ssl/
â”œâ”€â”€ mail/
â”œâ”€â”€ preflight/
â”œâ”€â”€ rollback/
â””â”€â”€ utils/

Describe the exact responsibility of each directory:

bootstrap/ â†’ main orchestration logic

steps/ â†’ sequential execution scripts

templates/ â†’ configuration templates (nginx, env, config.json, etc.)

systemd/ â†’ service unit files

nginx/ â†’ reverse proxy and API routing configuration

database/ â†’ SQL scripts and migrations

ssl/ â†’ certificate generation and renewal

mail/ â†’ SMTP / IMAP configuration

preflight/ â†’ system validation checks

rollback/ â†’ recovery and restoration logic

utils/ â†’ shared utilities (logging, colors, error handling)

ğŸ” Security Requirements

The instruction file must enforce:

Automatic generation of strong passwords

Secure credential storage

No plaintext passwords inside scripts

Daemon isolation under a dedicated system user

Admin port protection (firewall + IP whitelist or authentication)

Mandatory reverse proxy

Fail2Ban activation

Strict UFW configuration

âš™ï¸ Technical Requirements

Document that:

The daemon must be installed and registered as a systemd service

The API gateway must correctly route to the daemon

The UI panel must be installed and built (if required)

Services must be enabled and validated

A post-install summary must display:

Panel URL

API port

Admin credentials

Log file locations

ğŸ” Error Handling Requirements

The document must require:

set -euo pipefail

Centralized logging

Atomic installation steps

Automatic rollback for critical failures

Installation state file tracking